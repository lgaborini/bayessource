<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Lorenzo Gaborini" />

<meta name="date" content="2017-07-26" />

<title>Introduction</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction</h1>
<h4 class="author"><em>Lorenzo Gaborini</em></h4>
<h4 class="date"><em>2017-07-26</em></h4>



<p>This vignette explains briefly how to use this package.</p>
<div id="package-goal" class="section level2">
<h2>Package goal</h2>
<p>The package has been conceived to evaluate whether two sets of items (a reference set and a questioned set) belong to the same population or not. Each item is described with a vector of measurements.</p>
<p>The evaluation is performed using Bayesian statistics, particularly Gibbs sampling. Particular care has been given in order to obtain performing functions: the main core has been written using <code>Rcpp</code>.</p>
<p>For theoretical details, see <span class="citation">(Bozza et al. 2008)</span>.</p>
</div>
<div id="package-contents" class="section level2">
<h2>Package contents</h2>
</div>
<div id="usage" class="section level1">
<h1>Usage</h1>
<p>This section describes the usage on some made-up data.</p>
<div id="sample-data" class="section level2">
<h2>Sample data</h2>
<p>We create some dummy data, taken from two bivariate Gaussian distributions with known means and covariances. Covariance matrices are generated using the bundled <code>rwish</code> function, to obtain invertible matrices with ease.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)

p &lt;-<span class="st"> </span><span class="dv">2</span>
mean.quest &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)
mean.ref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)
cov.quest &lt;-<span class="st"> </span><span class="kw">rwish</span>(<span class="dv">3</span>, <span class="kw">diag</span>(<span class="dv">2</span>))
cov.ref &lt;-<span class="st"> </span><span class="kw">rwish</span>(<span class="dv">5</span>, <span class="kw">diag</span>(<span class="dv">2</span>))
n.quest &lt;-<span class="st"> </span><span class="dv">20</span>
n.ref &lt;-<span class="st"> </span>n.quest

df.quest &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rmvnorm</span>(n.quest, mean.quest, cov.quest))
df.ref &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rmvnorm</span>(n.ref, mean.ref, cov.ref))</code></pre></div>
<p>Here are the datasets:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X1, <span class="dt">y =</span> X2), <span class="dt">col =</span> <span class="st">'red'</span>, <span class="dt">data =</span> df.quest) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X1, <span class="dt">y =</span> X2), <span class="dt">col =</span> <span class="st">'blue'</span>, <span class="dt">data =</span> df.ref)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is clear that the two samples come from different populations, hence we expect a low likelihood-ratio value.</p>
</div>
<div id="model-and-prior-specification" class="section level2">
<h2>Model and prior specification</h2>
<p>The package implements a two-sample Bayesian Hierarchical model with Gaussian multivariate likelihoods, and Inverse-Wishart prior on the covariance matrices.<br />
The theoretical details are specified in <span class="citation">(Bozza et al. 2008)</span>.</p>
<p>Let us recall the model definition. We note with <span class="math inline">\(X_{ij}\)</span> the <span class="math inline">\(j\)</span>-th sample from the <span class="math inline">\(i\)</span>-th population, <span class="math inline">\(i = 1,2\)</span>. The two populations are Gaussians, with means <span class="math inline">\(\theta_i\)</span>, and covariances <span class="math inline">\(W_i\)</span>. <span class="math display">\[
X_{ij} \; | \; \theta_i, \; W_i \sim \quad N(\theta_i, W_i) \quad \forall j = 1, \ldots, n \]</span> <span class="math display">\[\theta_i \; | \; \mu, B \sim \quad N(\mu, B)\]</span> <span class="math display">\[W_i \; | \; U, n_w \sim \quad IW(U, n_w)\]</span></p>
<p>where <span class="math inline">\(n_w &gt; 2p\)</span>, and <span class="math inline">\(U\)</span> is s.t. <span class="math display">\[ E[W_i] = \frac{U}{n_w - 2(p + 1)} \]</span> (parametrization according to <span class="citation">(Press 2012)</span>).</p>
<p>As the model is Bayesian, we are required to specify the hyperparameters <span class="math inline">\(\mu, B, U, n_w\)</span>, as well as the Gibbs chain initialization <span class="math inline">\(W_i\)</span>.<br />
Notice that inference is propagated by supplying the inverses of covariance matrices, i.e. <span class="math inline">\(B^{-1}\)</span> and <span class="math inline">\(W_i^{-1}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eps &lt;-<span class="st"> </span><span class="fl">0.001</span>
B.inv &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
W.inv.<span class="dv">1</span> &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
W.inv.<span class="dv">2</span> &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
U &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
nw &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(p <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
mu &lt;-<span class="st"> </span>(mean.quest <span class="op">+</span><span class="st"> </span>mean.ref)<span class="op">/</span><span class="dv">2</span></code></pre></div>
</div>
<div id="log-lr-computation" class="section level2">
<h2>Log-LR computation</h2>
<p>Once the parameters are specified, we can compute the marginal likelihood (not particularly useful):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">burn.in =<span class="st"> </span><span class="dv">1000</span>
n.iter =<span class="st"> </span><span class="dv">10000</span>
<span class="kw">marginalLikelihood</span>(<span class="kw">as.matrix</span>(df.quest), n.iter, B.inv, W.inv.<span class="dv">1</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] -103.1976</code></pre></div>
<p>and the log-LR value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">samesource_C</span>(<span class="kw">as.matrix</span>(df.quest), <span class="kw">as.matrix</span>(df.ref), n.iter, B.inv, W.inv.<span class="dv">1</span>, W.inv.<span class="dv">2</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] 5.318163</code></pre></div>
<p>Notice how low it is compared to a subset of original data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">samesource_C</span>(<span class="kw">as.matrix</span>(df.ref)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,], <span class="kw">as.matrix</span>(df.ref), n.iter, B.inv, W.inv.<span class="dv">1</span>, W.inv.<span class="dv">2</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] 44.94793</code></pre></div>
</div>
</div>
<div id="diagnostics" class="section level1">
<h1>Diagnostics</h1>
<p>The package supports the output of the entire chain for <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(W^{-1}_i\)</span> (i.e., the inverses of <span class="math inline">\(W_i\)</span>).<br />
At the time, this is possible only during the computation of a single marginal likelihood, in this case the one related to the sample from the questioned population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">marginalLikelihood</span>(<span class="kw">as.matrix</span>(df.quest), n.iter, B.inv, W.inv.<span class="dv">1</span>, U, nw, mu, burn.in, <span class="dt">output.mcmc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Notice that <code>results</code> now is a <code>list</code>, where <code>results$LR.num</code> holds the marginal likelihood value, and <code>results$mcmc</code> is the <code>coda</code> object which holds the chain output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(results<span class="op">$</span>mcmc, <span class="dv">4</span>)
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1001 
## End = 1005 
## Thinning interval = 1 
##          theta.1    theta.2  W.inv.1   W.inv.2   W.inv.3   W.inv.4
## [1,] -0.05124708 -0.5158918 2.080576 0.8013721 0.8013721 0.6182008
## [2,]  0.15890906 -1.3313169 4.199290 1.5187373 1.5187373 0.7825987
## [3,]  0.07012506 -1.0277897 4.421625 1.3296159 1.3296159 0.7385559
## [4,]  0.13466603 -1.1318374 2.637289 0.8712054 0.8712054 0.6912608
## [5,]  0.33203618 -1.1898417 1.833229 0.6652245 0.6652245 0.5865550</code></pre></div>
<p>Remember that R is column-major: <code>W.inv.1</code> is <span class="math inline">\(W^{-1}_1(1,1)\)</span>, <code>W.inv.2</code> is <span class="math inline">\(W^{-1}_1(2,1)\)</span> and so on.<br />
Using standard <code>coda</code> tools, we can perform diagnostics, such as summaries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coda)
<span class="kw">summary</span>(results<span class="op">$</span>mcmc)</code></pre></div>
<pre><code>## 
## Iterations = 1001:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 9000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##            Mean     SD Naive SE Time-series SE
## theta.1  0.1790 0.1877 0.001978       0.001925
## theta.2 -1.0844 0.4032 0.004250       0.004166
## W.inv.1  3.2366 0.8990 0.009476       0.009776
## W.inv.2  1.0592 0.3619 0.003815       0.003897
## W.inv.3  1.0592 0.3619 0.003815       0.003897
## W.inv.4  0.7002 0.1942 0.002047       0.002088
## 
## 2. Quantiles for each variable:
## 
##            2.5%      25%     50%     75%   97.5%
## theta.1 -0.1927  0.05481  0.1799  0.3026  0.5479
## theta.2 -1.8773 -1.34763 -1.0813 -0.8189 -0.2814
## W.inv.1  1.7615  2.59596  3.1426  3.7951  5.2473
## W.inv.2  0.4540  0.79795  1.0292  1.2811  1.8676
## W.inv.3  0.4540  0.79795  1.0292  1.2811  1.8676
## W.inv.4  0.3676  0.56185  0.6845  0.8177  1.1201</code></pre>
<p>and traceplots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">traceplot</span>(results<span class="op">$</span>mcmc)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAAEgAAHQASEgASHQASJwAdJwAdL9IAABIAEhIAHRISABISEhISHRISJxIdHRIdJxIdL9InJxInL9InN90AAB0AEh0SAB0SEh0nL90nN90v790v990v/+cSACcdEicnEicnHScnL+cv5ycv9+c39+c3/+/dAC/dEi/nHS/35y/39+/3/+//7+////fnEjfnHTfv3Tfv5zf37/f39/f3//f/7/f////v3T/35z/37///7///9/////buuzxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKhklEQVR4nO2dbWPrtBmGn3btGmBsnC2BwU7K2GEnDA7NBmN1T6L//7emF0uW/HY7cZzI6X19aBxbeiRdkWS3VWxRpBe5dAVyh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJMKGgjgYcRYfY/LETe6I3dSu6flXpZyM17vftRbp/s8Ue7G1ZmQKI28hdUmABLFZQU7q3W5aIOEbT/Qa5X0NZ2mGpr4+LpjrQcGuKXryRHQQb98To5unHvvpLbD66yn7sm/+czkd+9ten0R3zzJmrCL3/Vh75+LjU7RYXpOjqimJ6k36x9EbrtOv4/dYw7a9COvZBAH5ObRf6CxH6KhetStsVlF3PjxXD35PO55KZRkSDdaR500pvvzPvQsbygELg0U806W7n7adBE1cYZBd1/UP/V73//XA4P3ZC/PH9cmc97Y/pWNGheFmWjl/EQsyoKuf3RJAztD4LuPrgcrkzt3Ef795vnYTN5G2cUtC73/fqvz+ws4obC9ouffGO25XkpjBL7Ugmy77fyYIKGwJWgddnHXJwomxp6qmvjjHOQre/+Wz9tR3XW7YpGXtWcbTKWbJ97+6hdagM/hw4S5qD3/tSmw61rRmYjyEyxd//4deUE+ZNbIakgfwq3s0kkSLf8zys7y9y8WyQDLxFkItdOcrMR5Oq9WzV60LqWq7UH2blcDx/9+ocwHJuCTA/7ezLC5iOo8FPF0k80xeffVxd9no45yF8D2VO9b3CLIDtkEyGzEWRPTx8fbTO1LHt60co2cvNWfVzFXarlLObO/svq1Ta7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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAAEgAAHQASEgASHQASJwAdJwAdL9IAABIAEhIAHRISABISEhISHRIdJxIdL9InJxInL9InN90AAB0AEh0SAB0SEh0nL90nN90v790v990v/+cSACcdEicnEicnHScnL+cv5ycv9+c39+c3/+/dAC/dEi/nHS/35y/39+/3/+//7+////fnEjfv3Tfv5zf37/f39/f/7/f////v3T/35z/37///7///9////8dwnyCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALJUlEQVR4nO3dC3ujxhkF4M/OunabyzZSsk3X3iabWkm6sbJpjS3P//9jnQszDDBwuAokn/M8u5YEfDCvhwHZCItiWiNLb8DaQyAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUBmBNpJyPWIMi+/3Ii81Q8OW7l6VOrpRi7u9ct3cvlgp9/Zl9vy/EHk4h9gpoasHygzBTYqkGTuqeZyVTGQnnX4RqwfaG87TPFo5+rpjrTpXEHem/9uh6x+5jFIf3sdjm7cx+/l8pP6/L1u4NeuyX98KfLFezvfL3oneBt1hM/v9CSzV1hmR5SZrqMriulJmW+w60G6/r91jTdW0O57xQy/fqVn0KArBzK5esxcl7ItzrvYJuwEbx78cm520/IISLfxWs968aN5HjqWBwqFc5ldac972YWO2C9HBLr6pP6rn//lMd89dEO+fXzemu/3zvStaKfRD12jN/EuZikyufzNzBjaH4DefHJLuHVq82gXzFznGpAjAvke/uevX9pRxO0K+2/+4xuzz49LYS+xXwog+3wv16ZoKFwA3eZ9zNXZl3qM6WBvB7XgiGOQ3d6XD37Yjo4+ul3RnlccmPalfcn2g/d32lIL/B46SBiD7v2hzQw3tWPb5+6DeilHBjJD7Juf/tw6IH9wy6QM5A/hdjSJgHTL/761o8zFx5vSjlcCMpXrB7ld6J+9cmQgt92Hba0H3VaWSvYgO5brZuqvX4Xm1oFMD/tXbUw+DaDMDxUbv8XZ1z8XJ30+DWOQPweyh3qvmwCyu2zYw57f3WxU9ajWOcfvQVePz3e2mRrr7aNp663e+Iv36nkbd6nEUcyNtZviq7VJAFnIW1XMoKf9ISczBoVz6114mJ8HlSXyXhADZXnD86+NQJm4Luim5ceAQR1okaPYm5/zA7o9k/7BvPz8QTfim0/FgvZM+od4SZPD1i2ov+ZvWNNA/ms+mD2/W+Wb1fMIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCATA8nJZCmgacvNFwKBEAjkBIGOa3v6QC2VpthmAvVb27wrm6ZcNyAZtxJUfsSMs5cjUL9FhwN12oaTBJLy08YVDAOSLjN1rjY0qwJqIzkyUP+3OKktOWOgKcq9ViCRjg0iEFiGQGCZQUCpuQqgloKnDdTSTc4FqCjbE0j8K32Bqo8kAOWLSGm2cwBKLkYg/0p1MfHVkkDSDCQEcnOXD14SA0kxfWYg/6nuxnsYROv37U4BpUbPcwDa+8/mZ00f0m8BksRs8ROJ9oqE6ykAvdwFln3Dp/QnBqpRFO2urm8NQIdtuAVJ1rCTQaAqlkwAJKoEEAGJOirQFD2oNLxIZyDpAiSqFSh/0rPdPcegvAsNGIOkCiQlIDkLIH8Tkub7hHQGkiYg38pot1BtQLIqoM7lJLSpBiQ9gVy7JAUkpwzk2iQloPyFCEh8NxH/pAokBZBIM5D4iWGJHEiWAdrDo5j7AWwFSAYBSRIoNL4HkBwNqFql+jPpGCj0pCagMC51BQpDc/S6+BWWgGQlQNVyEoCkgOoAJB2ApCOQhC04AaBi5wheHYFK3TCUREBSAwoV5gUytxazp0JgDJoCSNJAvp6KxRBQ8XheoP3FvT4Vup4eKG7H9EClx3MCubcaL3fmnmoIqLp5Km5J6PGJV5uBYp8IqDIt3qdSQFLa0GmB/JvV3dXjJEDJV3sAVZueAiotMzdQeLO6u54OSKQKJBGQf+E0gMKO5W9n2A+oRtEZqIogtRFpJUDh7fzLXV+g8ja2syVeqDe2HSi9zPxAXcs1tyv5tAGoLarpGYFeIxCaDc6B5y/mOimgkbP1THEesV6gfk2ZOATqVvUcgGYNgUBWALQ0QXuWAKqufdVZAqhSbmmC9hAIhEAgBAIhEAiBQAgEQiCQOYE6XuW6LADKjEBdr3JdmqA98wF1vkZxaYL2zAfU+SrXpQnaMx8QexBK16tclyZoz4xAXa9yXRYAZU6gjuWWJmgPgUCOAtR+dcfSBO05ClC1SmXtq84SQJVySxO0h0AgBAIhEMh8QP400YRHsVQar7wjUBC6bp/htQPpd6m3rdNfPVDHcksbtIZAIAQCIRAIgUAIBEIgkNcJ1HmV6nyBWquePlB7C7q075SBovX759WPwTV/hqzxA3B9DECB+JN9SwBVy6WBGj/15IDQnpn6pFCF3f/f8EE++6hnu+cFUnUgFW9rmBABFWpR8xKfAhsCpNYMpAogP82z+CVLzYsAAlDc8BqQ8sVjIFX9sjIgVQZSBVCYLwZSXkM1ASlfrBlIqciy8kWtBUhFQMp3Fz/dfZOVim381BhIeeEUkKoDqTJQmKEY/lYGlO82eauVxNPzr21ARWsrQPnsoVMmgFQVSOXflJUAhW0ML5VlypsZb0MJSCWAVAIofDOqWxC6sAqbU93Qzi2aJlJ7MASoNCUNpAogpeLuUQNKbdOqgErPIVC53/kXJN5TU0AqCVQtldpQlH5AnW9221RXWp9GL5WB4qY2APnpiwJ1v9ltx9WNBVJ1oPqT4wH1uFXpFKsLi1SAKrVWBNTjZrcTpgrUe10n1YMGpTS09F/XUcegrje7nTSnA9T9ZreTpgGoz+LdXhw14yLlJil6/kAjswgQutnt6nPkHhT9GOtEwl0MhEAgi71ZPZnMAoTfrI5YDZ5lkiJ9O/nEbzVGrOYMgDq8WR2xmjMAYg9CwW9WR6zmHIDwm9URqzkLoMEh0PjVEGj0LOcMdLohEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgkHmA7K+H7A8dM5GL+/QDmKcbketxRZ7+9gAKoEqzAL3c6XXuTeMy/cD8SzyAya4e3V9UHF7ksLW/XGgpACvNAvR0Y352vb98cD/m312r+gMYN+eoIpn7FWdLAVxpxjFIf2OCVP0BXPzpr/n3dXCRTDb211MtBXClGYF2ev22kVnqAVw8u/x9aweycUUeWgvgSvMBmV8Nub1b/19/AJffm93D3I9nTBHb9JYCuNJsQJkfowcDXeTf3PMEcr9aHLN3uIFBDxJnuYvl14GMGaTdVusWjC6ywkG6+HOjww/z7lKJbNy5QrbOw/zTjf/V/ZgTRXOBhG3AiCLZOk8U9+43+Ga9e38mX38Ak/n3K8OL5KNLSwFUiW9WQQgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiCQNQDZCwia/26ZnhTdFOPYWQlQi8CCOCYEAlkH0Mcbe7uLvbve5fDdj+YCzp1+dmsvt7/6n7uYKp+8/efWTLGTwJ8UHJ91ALkeZC7bNNdeHbbm3iDmsi/ziplkJ5u/r2iuvD9szXX8+UXY6I8ujs6KgA5bc7VUdvlgHxy+u3dXF3ogd7WcnXdjp/S9h9GwrAjIXQmnWx5GnUykAHLXW/rJ+r/8gxgzZ01A+e3XciA9IF3+dlMFsjAOyH2m6BWNQeFaSitgPZ5qQFEPsvPuOl7vODgrAgp7lhuS7TXykhyDIqDZTwJWA7TJP3ywywVc55GNHbsrRzEHFC7jnTUrAdInPfl5kO44YQy6uN+5SZXzoLwHZdL5iuLhWQPQqkMgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUD+DwfSUvrlbPzEAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can recover the original matrices by reshaping the desired columns (e.g. for <code>W.inv</code>) into a matrix/3D array:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n.samples &lt;-<span class="st"> </span><span class="kw">nrow</span>(results<span class="op">$</span>mcmc)
W.inv.samples &lt;-<span class="st"> </span>results<span class="op">$</span>mcmc[, <span class="kw">paste0</span>(<span class="st">'W.inv.'</span>, <span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>(p<span class="op">^</span><span class="dv">2</span>)))]
<span class="kw">head</span>(W.inv.samples, <span class="dv">5</span>)
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1001 
## End = 1006 
## Thinning interval = 1 
##       W.inv.1   W.inv.2   W.inv.3   W.inv.4
## [1,] 2.080576 0.8013721 0.8013721 0.6182008
## [2,] 4.199290 1.5187373 1.5187373 0.7825987
## [3,] 4.421625 1.3296159 1.3296159 0.7385559
## [4,] 2.637289 0.8712054 0.8712054 0.6912608
## [5,] 1.833229 0.6652245 0.6652245 0.5865550
## [6,] 3.387628 0.8772191 0.8772191 0.5088544
W.inv.samples.cube &lt;-<span class="st"> </span><span class="kw">array</span>(W.inv.samples, <span class="dt">dim =</span> <span class="kw">c</span>(n.samples, p, p))
<span class="kw">dim</span>(W.inv.samples.cube)
## [1] 9000    2    2</code></pre></div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Bozza2008Probabilistic">
<p>Bozza, Silvia, Franco Taroni, Raymond Marquis, and Matthieu Schmittbuhl. 2008. “Probabilistic Evaluation of Handwriting Evidence: Likelihood Ratio for Authorship.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 57 (3): 329–41. doi:<a href="https://doi.org/10.1111/j.1467-9876.2007.00616.x">10.1111/j.1467-9876.2007.00616.x</a>.</p>
</div>
<div id="ref-Press2012Applied">
<p>Press, S James. 2012. <em>Applied Multivariate Analysis: Using Bayesian and Frequentist Methods of Inference</em>. Courier Corporation.</p>
</div>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
