<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Lorenzo Gaborini" />

<meta name="date" content="2017-12-21" />

<title>Introduction</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction</h1>
<h4 class="author"><em>Lorenzo Gaborini</em></h4>
<h4 class="date"><em>2017-12-21</em></h4>



<p>This vignette explains briefly how to use this package.</p>
<div id="package-goal" class="section level1">
<h1>Package goal</h1>
<p>The package has been conceived to evaluate the hypothesis whether two sets of items (a reference set and a questioned set) belong to the same population or not.<br />
Each item is described with a vector of <span class="math inline">\(p\)</span> measurements.</p>
<p>The evaluation is performed using Bayesian statistics, particularly Gibbs sampling.</p>
<p>The model we applied is that these populations are represented as samples from Multivariate Gaussian distributions, with unknown means and covariance matrices.</p>
<p>Particular care has been given in order to obtain strongly performing functions. The main core is written using <code>Rcpp</code>.</p>
<p>For more theoretical details, see <span class="citation">(Bozza et al. 2008)</span>.</p>
<div id="package-contents" class="section level2">
<h2>Package contents</h2>
<p>The package supplies several functions to compute common densities (e.g. Wishart, Inverted Wishart), and two functions to compute the marginal likelihood of observations, as well as the full Likelihood Ratio (<code>marginalLikelihood</code>, <code>samesource_C</code>).</p>
</div>
</div>
<div id="usage" class="section level1">
<h1>Usage</h1>
<p>This section describes the usage on some made-up data.</p>
<div id="sample-data" class="section level2">
<h2>Sample data</h2>
<p>We create some dummy data, taken from two bivariate Gaussian distributions with known means and covariances. Covariance matrices are generated using the bundled <code>rwish</code> function, to obtain invertible matrices with ease.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)

p &lt;-<span class="st"> </span><span class="dv">2</span>
mean.quest &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)
mean.ref &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)
cov.quest &lt;-<span class="st"> </span><span class="kw">rwish</span>(<span class="dv">3</span>, <span class="kw">diag</span>(<span class="dv">2</span>))
cov.ref &lt;-<span class="st"> </span><span class="kw">rwish</span>(<span class="dv">5</span>, <span class="kw">diag</span>(<span class="dv">2</span>))
n.quest &lt;-<span class="st"> </span><span class="dv">20</span>
n.ref &lt;-<span class="st"> </span>n.quest

df.quest &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rmvnorm</span>(n.quest, mean.quest, cov.quest))
df.ref &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rmvnorm</span>(n.ref, mean.ref, cov.ref))</code></pre></div>
<p>Here are the datasets:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X1, <span class="dt">y =</span> X2), <span class="dt">col =</span> <span class="st">'red'</span>, <span class="dt">data =</span> df.quest) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X1, <span class="dt">y =</span> X2), <span class="dt">col =</span> <span class="st">'blue'</span>, <span class="dt">data =</span> df.ref)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is clear that the two samples come from different populations, hence we expect a low likelihood-ratio value.</p>
</div>
<div id="model-and-prior-specification" class="section level2">
<h2>Model and prior specification</h2>
<p>The package implements a two-sample Bayesian Hierarchical model with Gaussian multivariate likelihoods, and Inverse-Wishart prior on the covariance matrices.<br />
The theoretical details are specified in <span class="citation">(Bozza et al. 2008)</span>.</p>
<p>Let us recall the model definition. We note with <span class="math inline">\(X_{ij}\)</span> the <span class="math inline">\(j\)</span>-th sample from the <span class="math inline">\(i\)</span>-th population, <span class="math inline">\(i = 1,2\)</span>. The two populations are Gaussians, with means <span class="math inline">\(\theta_i\)</span>, and covariances <span class="math inline">\(W_i\)</span>. <span class="math display">\[
X_{ij} \; | \; \theta_i, \; W_i \sim \quad N(\theta_i, W_i) \quad \forall j = 1, \ldots, n \]</span> <span class="math display">\[\theta_i \; | \; \mu, B \sim \quad N(\mu, B)\]</span> <span class="math display">\[W_i \; | \; U, n_w \sim \quad IW(U, n_w)\]</span></p>
<p>where <span class="math inline">\(n_w &gt; 2p\)</span>, and <span class="math inline">\(U\)</span> is s.t. <span class="math display">\[ E[W_i] = \frac{U}{n_w - 2(p + 1)} \]</span> (parametrization according to <span class="citation">(Press 2012)</span>).</p>
<p>As the model is Bayesian, we are required to specify the hyperparameters <span class="math inline">\(\mu, B, U, n_w\)</span>, as well as the Gibbs chain initialization <span class="math inline">\(W_i\)</span>.<br />
Notice that inference is propagated by supplying the inverses of covariance matrices, i.e. <span class="math inline">\(B^{-1}\)</span> and <span class="math inline">\(W_i^{-1}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eps &lt;-<span class="st"> </span><span class="fl">0.1</span>
B.inv &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
W.inv.<span class="dv">1</span> &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
W.inv.<span class="dv">2</span> &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
U &lt;-<span class="st"> </span>eps<span class="op">*</span><span class="kw">diag</span>(p)
nw &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(p <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
mu &lt;-<span class="st"> </span>(mean.quest <span class="op">+</span><span class="st"> </span>mean.ref)<span class="op">/</span><span class="dv">2</span></code></pre></div>
</div>
<div id="log-lr-computation" class="section level2">
<h2>Log-LR computation</h2>
<p>Once the parameters are specified, we can compute the marginal likelihood (not particularly useful):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">burn.in =<span class="st"> </span><span class="dv">1000</span>
n.iter =<span class="st"> </span><span class="dv">10000</span>
<span class="kw">marginalLikelihood</span>(<span class="kw">as.matrix</span>(df.quest), n.iter, B.inv, W.inv.<span class="dv">1</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] -80.5086</code></pre></div>
<p>and the log-LR value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">samesource_C</span>(<span class="kw">as.matrix</span>(df.quest), <span class="kw">as.matrix</span>(df.ref), n.iter, B.inv, W.inv.<span class="dv">1</span>, W.inv.<span class="dv">2</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] -8.670725</code></pre></div>
<p>Notice how low it is compared to a subset of original data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">samesource_C</span>(<span class="kw">as.matrix</span>(df.ref)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,], <span class="kw">as.matrix</span>(df.ref), n.iter, B.inv, W.inv.<span class="dv">1</span>, W.inv.<span class="dv">2</span>, U, nw, mu, burn.in, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
## [1] 22.02843</code></pre></div>
</div>
</div>
<div id="diagnostics" class="section level1">
<h1>Diagnostics</h1>
<p>The package supports the output of the entire chain for <span class="math inline">\(\theta_i\)</span> and <span class="math inline">\(W^{-1}_i\)</span> (i.e., the inverses of <span class="math inline">\(W_i\)</span>).<br />
At the time, this is possible only during the computation of a single marginal likelihood, in this case the one related to the sample from the questioned population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">marginalLikelihood</span>(<span class="kw">as.matrix</span>(df.quest), n.iter, B.inv, W.inv.<span class="dv">1</span>, U, nw, mu, burn.in, <span class="dt">output.mcmc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Notice that <code>results</code> now is a <code>list</code>, where <code>results$value</code> holds the marginal likelihood value, and <code>results$mcmc</code> is the <code>coda</code> object which holds the chain output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(results<span class="op">$</span>mcmc, <span class="dv">4</span>)</code></pre></div>
<pre><code>## Markov Chain Monte Carlo (MCMC) output:
## Start = 1001 
## End = 1005 
## Thinning interval = 1 
##          theta.1    theta.2  W.inv.1   W.inv.2   W.inv.3   W.inv.4
## [1,] -0.05648638 -0.4982845 2.052814 0.7903736 0.7903736 0.6118947
## [2,]  0.15320595 -1.3119157 4.145302 1.5008868 1.5008868 0.7770089
## [3,]  0.06222307 -1.0049877 4.362410 1.3116315 1.3116315 0.7323424
## [4,]  0.12987014 -1.1137403 2.602908 0.8595322 0.8595322 0.6868988
## [5,]  0.32830751 -1.1711867 1.806805 0.6542523 0.6542523 0.5819349</code></pre>
<p>Remember that R is column-major: <code>W.inv.1</code> is <span class="math inline">\(W^{-1}_1(1,1)\)</span>, <code>W.inv.2</code> is <span class="math inline">\(W^{-1}_1(2,1)\)</span> and so on.<br />
Using standard <code>coda</code> tools, we can perform diagnostics, such as summaries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coda)
<span class="kw">summary</span>(results<span class="op">$</span>mcmc)</code></pre></div>
<pre><code>## 
## Iterations = 1001:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 9000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##            Mean     SD Naive SE Time-series SE
## theta.1  0.1738 0.1871 0.001972       0.001921
## theta.2 -1.0640 0.3995 0.004211       0.004132
## W.inv.1  3.1932 0.8870 0.009349       0.009645
## W.inv.2  1.0435 0.3576 0.003769       0.003848
## W.inv.3  1.0435 0.3576 0.003769       0.003848
## W.inv.4  0.6943 0.1926 0.002030       0.002069
## 
## 2. Quantiles for each variable:
## 
##            2.5%      25%     50%     75%   97.5%
## theta.1 -0.1968  0.04953  0.1751  0.2971  0.5403
## theta.2 -1.8445 -1.32592 -1.0621 -0.8020 -0.2678
## W.inv.1  1.7369  2.56198  3.1016  3.7443  5.1731
## W.inv.2  0.4429  0.78455  1.0140  1.2625  1.8406
## W.inv.3  0.4429  0.78455  1.0140  1.2625  1.8406
## W.inv.4  0.3647  0.55710  0.6783  0.8103  1.1113</code></pre>
<p>and traceplots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">traceplot</span>(results<span class="op">$</span>mcmc)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can recover the original matrices by reshaping the desired columns (e.g. for <code>W.inv</code>) into a matrix/3D array:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n.samples &lt;-<span class="st"> </span><span class="kw">nrow</span>(results<span class="op">$</span>mcmc)
W.inv.samples &lt;-<span class="st"> </span>results<span class="op">$</span>mcmc[, <span class="kw">paste0</span>(<span class="st">'W.inv.'</span>, <span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>(p<span class="op">^</span><span class="dv">2</span>)))]
<span class="kw">head</span>(W.inv.samples, <span class="dv">5</span>)</code></pre></div>
<pre><code>## Markov Chain Monte Carlo (MCMC) output:
## Start = 1001 
## End = 1006 
## Thinning interval = 1 
##       W.inv.1   W.inv.2   W.inv.3   W.inv.4
## [1,] 2.052814 0.7903736 0.7903736 0.6118947
## [2,] 4.145302 1.5008868 1.5008868 0.7770089
## [3,] 4.362410 1.3116315 1.3116315 0.7323424
## [4,] 2.602908 0.8595322 0.8595322 0.6868988
## [5,] 1.806805 0.6542523 0.6542523 0.5819349
## [6,] 3.343988 0.8641796 0.8641796 0.5048585</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">W.inv.samples.cube &lt;-<span class="st"> </span><span class="kw">array</span>(W.inv.samples, <span class="dt">dim =</span> <span class="kw">c</span>(n.samples, p, p))
<span class="kw">dim</span>(W.inv.samples.cube)</code></pre></div>
<pre><code>## [1] 9000    2    2</code></pre>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Bozza2008Probabilistic">
<p>Bozza, Silvia, Franco Taroni, Raymond Marquis, and Matthieu Schmittbuhl. 2008. “Probabilistic Evaluation of Handwriting Evidence: Likelihood Ratio for Authorship.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 57 (3): 329–41. doi:<a href="https://doi.org/10.1111/j.1467-9876.2007.00616.x">10.1111/j.1467-9876.2007.00616.x</a>.</p>
</div>
<div id="ref-Press2012Applied">
<p>Press, S James. 2012. <em>Applied Multivariate Analysis: Using Bayesian and Frequentist Methods of Inference</em>. Courier Corporation.</p>
</div>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
